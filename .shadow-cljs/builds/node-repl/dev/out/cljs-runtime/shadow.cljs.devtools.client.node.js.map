{"version":3,"sources":["shadow/cljs/devtools/client/node.cljs"],"mappings":"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","names":["js/shadow","js/shadow.cljs","js/shadow.cljs.devtools","js/shadow.cljs.devtools.client","js/shadow.cljs.devtools.client.node","js/shadow.cljs.devtools.client.node.client-id","shadow.cljs.devtools.client.node/client-id","cljs.core/random-uuid","js/shadow.cljs.devtools.client.node.ws-ref","shadow.cljs.devtools.client.node/ws-ref","cljs.core/volatile!","shadow.cljs.devtools.client.node/ws-close","temp__5724__auto__","cljs.core/deref","tcp","cljs.core/vreset!","shadow.cljs.devtools.client.node/ws-msg","msg","ws","cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic","err","js/console.error","p__29261","map__29262","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","shadow.cljs.devtools.client.node/node-eval","js","source-map-json","result","js/SHADOW_NODE_EVAL","shadow.cljs.devtools.client.node/is-loaded?","src","goog.object/get","js/SHADOW_IMPORTED","js/Error","shadow.cljs.devtools.client.node/closure-import","js/SHADOW_IMPORT","p__29270","map__29271","shadow.cljs.devtools.client.node/repl-init","id","repl-state","map__29273","repl-sources","seq__29275","cljs.core/seq","chunk__29277","count__29278","i__29279","map__29285","temp__5720__auto__","cljs.core/chunked-seq?","c__4550__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","map__29288","cljs.core/first","cljs.core/next","output-name","p__29290","map__29291","shadow.cljs.devtools.client.node/repl-invoke","shadow.cljs.devtools.client.env/repl-call","shadow.cljs.devtools.client.env/repl-error","cljs.core.assoc.cljs$core$IFn$_invoke$arity$3","p__29293","map__29294","shadow.cljs.devtools.client.node/repl-set-ns","p__29309","map__29311","shadow.cljs.devtools.client.node/repl-require","sources","reload-namespaces","e29314","seq__29319","chunk__29320","count__29321","i__29322","map__29336","map__29338","provides","or__4131__auto__","cljs.core/some","e","p__29340","map__29341","shadow.cljs.devtools.client.node/build-complete","info","reload-info","map__29343","compiled","warnings","iter__4523__auto__","s__29346","cljs.core/LazySeq","xs__6277__auto__","map__29351","iterys__4519__auto__","s__29348","c__4521__auto__","size__4522__auto__","b__29350","cljs.core/chunk-buffer","i__29349","cljs.core._nth.cljs$core$IFn$_invoke$arity$2","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__29347","cljs.core/cons","cljs.core/rest","fs__4520__auto__","cljs.core.concat.cljs$core$IFn$_invoke$arity$2","iter__29345","resource-name","cljs.core/not","warning","cljs.core.distinct.cljs$core$IFn$_invoke$arity$1","cljs.core.into.cljs$core$IFn$_invoke$arity$2","shadow.cljs.devtools.client.env/autoload","cljs.core/empty?","shadow.cljs.devtools.client.env/ignore-warnings","map__29353","files-to-require","cljs.core.remove.cljs$core$IFn$_invoke$arity$2","p__29358","map__29359","ns","cljs.core/contains?","cljs.core.filter.cljs$core$IFn$_invoke$arity$2","p__29355","map__29356","resource-id","cljs.core.map.cljs$core$IFn$_invoke$arity$2","shadow.cljs.devtools.client.env.do_js_reload.cljs$core$IFn$_invoke$arity$2","seq__29361","chunk__29362","count__29363","i__29364","shadow.cljs.devtools.client.env/before-load-src","p__29365","map__29366","shadow.cljs.devtools.client.node/process-message","type","G__29368","cljs.core/Keyword","cljs.core.prn.cljs$core$IFn$_invoke$arity$variadic","shadow.cljs.devtools.client.node/ws-connect","url","shadow.cljs.devtools.client.env/ws-url","client","js/shadow.js.shim.module$ws","req","res","status","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","js/console.log","data","flags","e29369","shadow.cljs.devtools.client.env/process-ws-msg","shadow.cljs.devtools.client.env/enabled"],"sourcesContent":["(ns shadow.cljs.devtools.client.node\n  (:require [shadow.cljs.devtools.client.env :as env]\n            [\"ws\" :as ws]\n            [cljs.reader :as reader]\n            [goog.object :as gobj]))\n\n(defonce client-id (random-uuid))\n\n(defonce ws-ref (volatile! nil))\n\n(defn ws-close []\n  (when-some [tcp @ws-ref]\n    (.close tcp)\n    (vreset! ws-ref nil)))\n\n(defn ws-msg [msg]\n  (when-some [ws @ws-ref]\n    (.send ws (pr-str msg)\n      (fn [err]\n        (when err\n          (js/console.error \"REPL msg send failed\" err))))\n    ))\n\n(defn node-eval [{:keys [js source-map-json] :as msg}]\n  (let [result (js/SHADOW_NODE_EVAL js source-map-json)]\n    result))\n\n(defn is-loaded? [src]\n  (true? (gobj/get js/SHADOW_IMPORTED src)))\n\n(defn closure-import [src]\n  {:pre [(string? src)]}\n  (js/SHADOW_IMPORT src))\n\n(defn repl-init\n  [{:keys [id repl-state] :as msg}]\n  (let [{:keys [repl-sources]} repl-state]\n\n    (doseq [{:keys [output-name] :as src} repl-sources\n            :when (not (is-loaded? output-name))]\n      (closure-import output-name))\n\n    (ws-msg {:type :repl/init-complete :id id})\n    ))\n\n(defn repl-invoke [{:keys [id] :as msg}]\n  (let [result\n        (-> (env/repl-call #(node-eval msg) env/repl-error)\n            (assoc :id id))]\n\n    (ws-msg result)))\n\n(defn repl-set-ns [{:keys [id] :as msg}]\n  ;; nothing for the client to do really\n  (ws-msg {:type :repl/set-ns-complete :id id}))\n\n(defn repl-require\n  [{:keys [id sources reload-namespaces] :as msg}]\n  (try\n    (doseq [{:keys [provides output-name] :as src} sources]\n      (when (or (not (is-loaded? output-name))\n                (some reload-namespaces provides))\n        (closure-import output-name)))\n    (ws-msg {:type :repl/require-complete :id id})\n\n    (catch :default e\n      (js/console.error \"repl/require failed\" e)\n      (ws-msg {:type :repl/require-error :id id})\n      )))\n\n(defn build-complete\n  [{:keys [info reload-info] :as msg}]\n  (let [{:keys [sources compiled]}\n        info\n\n        warnings\n        (->> (for [{:keys [resource-name warnings] :as src} sources\n                   :when (not (:from-jar src))\n                   warning warnings]\n               (assoc warning :resource-name resource-name))\n             (distinct)\n             (into []))]\n\n    (when (and env/autoload\n               (or (empty? warnings) env/ignore-warnings))\n      \n      (let [{:keys [sources compiled]}\n            info\n\n            files-to-require\n            (->> sources\n                 (remove (fn [{:keys [ns]}]\n                           (contains? (:never-load reload-info) ns)))\n                 (filter (fn [{:keys [ns resource-id]}]\n                           (or (contains? compiled resource-id)\n                               (contains? (:always-load reload-info) ns))))\n                 (map :output-name)\n                 (into []))]\n\n        (when (seq files-to-require)\n          (env/do-js-reload\n            msg\n            #(doseq [src files-to-require]\n               (env/before-load-src src)\n               (closure-import src))\n            ))))))\n\n(defn process-message\n  [{:keys [type] :as msg}]\n  ;; (js/console.log \"repl-msg\" msg)\n  (case type\n    :repl/init\n    (repl-init msg)\n\n    :repl/invoke\n    (repl-invoke msg)\n\n    :repl/set-ns\n    (repl-set-ns msg)\n\n    :repl/require\n    (repl-require msg)\n\n    :build-configure\n    :ignored\n\n    :build-start\n    :ignored\n\n    :build-complete\n    (build-complete msg)\n\n    :build-failure\n    :ignored\n\n    :worker-shutdown\n    (.terminate @ws-ref)\n\n    ;; default\n    (prn [:repl-unknown msg])\n    ))\n\n(defn ws-connect []\n  (let [url\n        (env/ws-url :node)\n\n        client\n        (ws. url [])]\n\n    (.on client \"open\"\n      (fn []\n        (vreset! ws-ref client)))\n\n    (.on client \"unexpected-response\"\n      (fn [req ^js res]\n        (let [status (.-statusCode res)]\n          (if (= 406 status)\n            (js/console.log \"REPL connection rejected, probably stale JS connecting to new server.\")\n            (js/console.log \"REPL unexpected error\" (.-statusCode res))\n            ))))\n\n    (.on client \"message\"\n      (fn [data flags]\n        (try\n          (env/process-ws-msg data process-message)\n          (catch :default e\n            (js/console.error \"failed to process message\" data e)))))\n\n    (.on client \"close\"\n      (fn []\n        (js/console.log \"REPL client disconnected\")\n        ))\n\n    (.on client \"error\"\n      (fn [err]\n        (js/console.log \"REPL client error\" err)))\n    ))\n\n(when env/enabled\n  (ws-close) ;; if this is reloaded, reconnect the socket\n  (ws-connect))\n\n"]}